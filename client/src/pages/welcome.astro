---
// src/pages/welcome.astro
import Layout from "../layouts/Layout.astro";
import Navbar from "../components/Navbar.astro";
import Footer from "../components/Footer.astro";
import LogoutBtn from "../components/LogoutBtn.astro";
---

<Layout title="Bienvenido | Instructiva">
  <Navbar />
  <LogoutBtn />
  <section
    class="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 flex items-center justify-center py-8"
  >
    <div class="container mx-auto px-4 max-w-4xl">
      <div id="welcomeContent" class="text-center">
        <!-- Loading state -->
        <div class="animate-pulse">
          <div class="h-8 bg-gray-300 rounded w-64 mx-auto mb-4"></div>
          <div class="h-64 bg-gray-300 rounded-lg"></div>
        </div>
      </div>
    </div>
  </section>

  <Footer />

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const userData = localStorage.getItem("currentUser");

      if (!userData) {
        window.location.href = "/iniciar-sesion";
        return;
      }

      const user = JSON.parse(userData);
      const container = document.getElementById("welcomeContent");
      if (!container) return;

      // Configuración de imágenes según el rol
      const roleImages = {
        admin: "/assets/imgRoles/Kirby.png",
        profesor: "/assets/imgRoles/Profesor.svg",
        estudiante: "/assets/imgRoles/Alumno.svg",
        pepino: "/assets/imgRoles/Pepinillo.png",
      };

      // Colores de fondo según el rol
      const roleColors = {
        admin: "from-red-800 to-rose-500",
        profesor: "from-blue-900 to-purple-500",
        estudiante: "from-blue-800 to-amber-500",
        pepino:"from-green-500 to-teal-500",
      };

      // @ts-ignore
      const userImage = roleImages[user.role];
      // @ts-ignore
      const bgColor = roleColors[user.role];

      // Contenido de bienvenida
      container.innerHTML = `
				<div class="bg-white rounded-2xl shadow-2xl overflow-hidden max-w-2xl mx-auto">
					<div class="bg-gradient-to-r ${bgColor} py-12 px-6 text-white">
						<h1 class="text-4xl md:text-5xl font-bold">${user.welcomeTitle}</h1>
						<p class="text-xl mt-4 opacity-90">${user.username}</p>
            <p class="text-xl mt-4 opacity-90">${user.welcomeMessage}</p>
					</div>

					<div class="p-8 justify-items-center">
						<img 
							src="${userImage}" 
							alt="${user.welcomeTitle}"
							class="max-w-dvh h-80 object-cover rounded-xl shadow-lg"
						/>
					</div>
				</div>
			`;
    });
  </script>
</Layout>
